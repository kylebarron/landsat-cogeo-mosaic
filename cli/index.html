



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="mosaicJSON tools for Landsat 8 imagery">
      
      
        <link rel="canonical" href="https://kylebarron.dev/landsat-cogeo-mosaic/cli/">
      
      
        <meta name="author" content="Kyle Barron">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.14">
    
    
      
        <title>CLI - landsat-cogeo-mosaic</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d3202873.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.ff0a5ce4.min.css">
      
      
        
        
        <meta name="theme-color" content="#2094f3">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,400i,700%7CFira+Code&display=fallback">
        <style>body,input{font-family:"Nunito Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Code",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cli" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://kylebarron.dev/landsat-cogeo-mosaic/" title="landsat-cogeo-mosaic" class="md-header-nav__button md-logo" aria-label="landsat-cogeo-mosaic">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            landsat-cogeo-mosaic
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              CLI
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/kylebarron/landsat-cogeo-mosaic/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    kylebarron/landsat-cogeo-mosaic
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://kylebarron.dev/landsat-cogeo-mosaic/" title="landsat-cogeo-mosaic" class="md-nav__button md-logo" aria-label="landsat-cogeo-mosaic">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"/></svg>

    </a>
    landsat-cogeo-mosaic
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/kylebarron/landsat-cogeo-mosaic/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    kylebarron/landsat-cogeo-mosaic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../install/" title="Install" class="md-nav__link">
      Install
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Examples
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Examples" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/global/" title="Global Basemap" class="md-nav__link">
      Global Basemap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../examples/stac/" title="STAC Features" class="md-nav__link">
      STAC Features
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        CLI
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="CLI" class="md-nav__link md-nav__link--active">
      CLI
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
    <nav class="md-nav" aria-label="create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-from-db" class="md-nav__link">
    create-from-db
  </a>
  
    <nav class="md-nav" aria-label="create-from-db">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metadata-download" class="md-nav__link">
    Metadata Download
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-into-sqlite" class="md-nav__link">
    Import into SQLite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    index
  </a>
  
    <nav class="md-nav" aria-label="index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#missing-quadkeys" class="md-nav__link">
    missing-quadkeys
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#search" class="md-nav__link">
    search
  </a>
  
    <nav class="md-nav" aria-label="search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize" class="md-nav__link">
    visualize
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
    <nav class="md-nav" aria-label="create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-from-db" class="md-nav__link">
    create-from-db
  </a>
  
    <nav class="md-nav" aria-label="create-from-db">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metadata-download" class="md-nav__link">
    Metadata Download
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-into-sqlite" class="md-nav__link">
    Import into SQLite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    index
  </a>
  
    <nav class="md-nav" aria-label="index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#missing-quadkeys" class="md-nav__link">
    missing-quadkeys
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#search" class="md-nav__link">
    search
  </a>
  
    <nav class="md-nav" aria-label="search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_3" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize" class="md-nav__link">
    visualize
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/kylebarron/landsat-cogeo-mosaic/blob/master/docs/src/cli.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="cli">CLI<a class="headerlink" href="#cli" title="Permanent link">&para;</a></h1>
<h3 id="create"><code>create</code><a class="headerlink" href="#create" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Usage: landsat-cogeo-mosaic create [OPTIONS] LINES

  Create MosaicJSON from STAC features

Options:
  --min-zoom INTEGER              Minimum zoom  [default: 7]
  --max-zoom INTEGER              Maximum zoom  [default: 12]
  --quadkey-zoom INTEGER          Zoom level used for quadkeys in MosaicJSON.
                                  Lower value means more assets per tile, but
                                  a smaller MosaicJSON file. Higher value
                                  means fewer assets per tile but a larger
                                  MosaicJSON file. Must be between min zoom
                                  and max zoom, inclusive.
  -b, --bounds TEXT               Comma-separated bounding box: &quot;west, south,
                                  east, north&quot;
  --optimized-selection / --no-optimized-selection
                                  Attempt to optimize assets in tile. This
                                  optimization implies that 1) assets will be
                                  ordered in the MosaicJSON in order of cover
                                  of the entire tile and 2) the total number
                                  of assets is kept to a minimum.  [default:
                                  True]
  --season [spring|summer|autumn|winter]
                                  Season, can provide multiple
  --help                          Show this message and exit.
</code></pre></div>

<h4 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h4>
<p><code>features.json</code> is output from <code>landsat-cogeo-mosaic search</code>.</p>
<div class="highlight"><pre><span></span><code>landsat-cogeo-mosaic create <span class="se">\</span>
    --bounds <span class="s1">&#39;-127.64,23.92,-64.82,52.72&#39;</span> <span class="se">\</span>
    --min-zoom <span class="m">7</span> <span class="se">\</span>
    --max-zoom <span class="m">12</span> <span class="se">\</span>
    --quadkey-zoom <span class="m">8</span> <span class="se">\</span>
    --optimized-selection <span class="se">\</span>
    --season summer <span class="se">\</span>
    features.json &gt; mosaic.json
</code></pre></div>

<h3 id="create-from-db"><code>create-from-db</code><a class="headerlink" href="#create-from-db" title="Permanent link">&para;</a></h3>
<p>Create MosaicJSON from SQLite database of Landsat features.</p>
<p>This is the fastest and most efficient way of creating a large Landsat
MosaicJSON, and I recommend it especially for global mosaics. But first you need
to create a local SQLite database of Landsat metadata.</p>
<h4 id="metadata-download">Metadata Download<a class="headerlink" href="#metadata-download" title="Permanent link">&para;</a></h4>
<p>Make sure you're in the top-level folder of the repository. Then download the
metadata from S3. This is about a 500MB file (uncompressed) as of April 2020,
but it grows over time as new scenes are added.</p>
<div class="highlight"><pre><span></span><code>aws s3 cp s3://landsat-pds/c1/L8/scene_list.gz data/
gunzip -c data/scene_list.gz &gt; data/scene_list
</code></pre></div>

<h4 id="import-into-sqlite">Import into SQLite<a class="headerlink" href="#import-into-sqlite" title="Permanent link">&para;</a></h4>
<p>I use SQLite to speed up processing with lots of data. The <code>csv_import.sql</code>
script creates a new table, imports the csv file, creates a couple new columns,
and creates indices. Note that the script must be run from the directory where
the file <code>scene_list</code> from above is stored.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> data/
sqlite3 scene_list.db &lt; ../scripts/csv_import.sql
<span class="nb">cd</span> -
</code></pre></div>

<p>The database takes up about 750MB, including indices.</p>
<h4 id="api">API<a class="headerlink" href="#api" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>Usage: landsat-cogeo-mosaic create-from-db [OPTIONS]

  Create MosaicJSON from SQLite database of Landsat features

Options:
  --sqlite-path PATH              Path to sqlite3 db generated from scene_list
                                  [required]
  --pathrow-index PATH            Path to pathrow-quadkey index  [required]
  --max-cloud FLOAT               Maximum cloud percentage  [default: 100]
  --min-date TEXT                 Minimum date, inclusive  [default:
                                  2013-01-01]
  --max-date TEXT                 Maximum date, inclusive  [default:
                                  2020-05-19]
  --min-zoom INTEGER              Minimum zoom  [default: 7]
  --max-zoom INTEGER              Maximum zoom  [default: 12]
  -p, --sort-preference [newest|oldest|closest-to-date|min-cloud]
                                  Method for choosing scenes in the same path-
                                  row  [default: newest]
  --closest-to-date TEXT          Date used for comparisons when preference is
                                  closest-to-date. Format must be YYYY-MM-DD
  --help                          Show this message and exit.
</code></pre></div>

<h4 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>landsat-cogeo-mosaic create-from-db <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Path to the sqlite database file` \</span>
    --sqlite-path data/scene_list.db <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Path to the path-row to quadkey index file. This is stored in Git` \</span>
    --pathrow-index data/pr_index.json.gz <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Min zoom of mosaic, 7 is a good default for Landsat` \</span>
    --min-zoom <span class="m">7</span> <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Max zoom of mosaic, 12 is a good default for Landsat` \</span>
    --max-zoom <span class="m">12</span> <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Maximum cloud cover. This means 5%` \</span>
    --max-cloud <span class="m">5</span> <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Preference for choosing the asset for a tile` \</span>
    --sort-preference closest-to-date <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Date used for comparisons when preference is closest-to-date` \</span>
    --closest-to-date <span class="s1">&#39;2018-04-01&#39;</span> <span class="se">\</span>
    &gt; mosaic.json
</code></pre></div>

<h3 id="index"><code>index</code><a class="headerlink" href="#index" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Usage: landsat-cogeo-mosaic index [OPTIONS]

  Create optimized index of path-row to quadkey_zoom

Options:
  --wrs-path PATH         Path to Shapefile (.shp) of WRS2 polygons. You can
                          download then extract from here
                          https://www.usgs.gov/media/files/landsat-
                          wrs-2-descending-path-row-shapefile  [required]
  --scene-path PATH       Path to CSV of scene metadata downloaded from AWS
                          S3.  [required]
  -b, --bounds TEXT       force bounding box: &quot;west, south, east, north&quot;
                          [default: -180,-90,180,90]
  --quadkey-zoom INTEGER  Zoom level used for quadkeys in MosaicJSON. Lower
                          value means more assets per tile, but a smaller
                          MosaicJSON file. Higher value means fewer assets per
                          tile but a larger MosaicJSON file. Must be between
                          min zoom and max zoom, inclusive.  [default: 8]
  --help                  Show this message and exit.
</code></pre></div>

<h4 id="example_2">Example<a class="headerlink" href="#example_2" title="Permanent link">&para;</a></h4>
<p>The index stored in the Git repository is created from the following. The output
is a gzipped, newline-delimited JSON file that maps path-rows to quadkeys at
zoom level 8.</p>
<div class="highlight"><pre><span></span><code>landsat-cogeo-mosaic index <span class="se">\</span>
    --wrs-path data/WRS2_descending_0/WRS2_descending.shp <span class="se">\</span>
    --scene-path data/scene_list.gz <span class="se">\</span>
    --quadkey-zoom <span class="m">8</span> <span class="se">\</span>
    <span class="p">|</span> gzip <span class="se">\</span>
    &gt; data/pr_index.json.gz
</code></pre></div>

<h3 id="missing-quadkeys"><code>missing-quadkeys</code><a class="headerlink" href="#missing-quadkeys" title="Permanent link">&para;</a></h3>
<p>Find missing quadkeys within <code>bounds</code> that are over land. The <code>shp-path</code> expects
to point to the unzipped 10m <a href="https://www.naturalearthdata.com/downloads/10m-physical-vectors/10m-land/">land polygons vector dataset
shapefile</a>
from Natural Earth.</p>
<div class="highlight"><pre><span></span><code>Usage: landsat-cogeo-mosaic missing-quadkeys [OPTIONS] FILE

  Find quadkeys over land missing from mosaic

Options:
  --shp-path PATH             path to Natural Earth shapefile of land
                              boundaries  [required]
  -b, --bounds TEXT           force bounding box: &quot;west, south, east, north&quot;
  --simplify / --no-simplify  Reduce size of the output tileset as much as
                              possible by merging leaves into parents.
                              [default: True]
  --help                      Show this message and exit.
</code></pre></div>

<h3 id="search"><code>search</code><a class="headerlink" href="#search" title="Permanent link">&para;</a></h3>
<p>Download metadata from a STAC API. This outputs newline-delimited GeoJSON
features. By default this searches the metadata of the Landsat 8 collection
using an API instance hosted by Development Seed.</p>
<div class="highlight"><pre><span></span><code>Usage: landsat-cogeo-mosaic search [OPTIONS]

  Retrieve features from sat-api

Options:
  -b, --bounds TEXT               Comma-separated bounding box: &quot;west, south,
                                  east, north&quot;  [required]
  --min-cloud FLOAT               Minimum cloud percentage  [default: 0]
  --max-cloud FLOAT               Maximum cloud percentage  [default: 100]
  --min-date TEXT                 Minimum date  [default: 2013-01-01]
  --max-date TEXT                 Maximum date, inclusive  [default:
                                  2020-05-19]
  --period [day|week|month|year]  Time period. If provided, overwrites `max-
                                  date` with the given period after `min-
                                  date`.
  --period-qty INTEGER            Number of periods to apply after `min-date`.
                                  Only applies if `period` is provided.
                                  [default: 1]
  --season [spring|summer|autumn|winter]
                                  Season, can provide multiple
  --stac-collection-limit INTEGER
                                  Limits the number of items per page returned
                                  by sat-api.  [default: 500]
  --help                          Show this message and exit.
</code></pre></div>

<h4 id="example_3">Example<a class="headerlink" href="#example_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>landsat-cogeo-mosaic search <span class="se">\</span>
    --bounds <span class="s1">&#39;-127.64,23.92,-64.82,52.72&#39;</span> <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Maximum 10% cloud cover` \</span>
    --max-cloud <span class="m">10</span> <span class="se">\</span>
    <span class="sb">`</span><span class="c1"># Imagery from 2019` \</span>
    --min-date <span class="m">2019</span>-01-01 <span class="se">\</span>
    --max-date <span class="m">2020</span>-01-01 <span class="se">\</span>
    --season summer &gt; features.json
</code></pre></div>

<p>Note that if the query would return more than 10,000 scenes, an error is
produced, as 10,000 is the <a href="https://github.com/sat-utils/sat-api/issues/225">max the API can
return</a>. However, since the
output is <em>newline-delimited</em> GeoJSON, you can append features easily:</p>
<div class="highlight"><pre><span></span><code>landsat-cogeo-mosaic search ... &gt;&gt; features.json
</code></pre></div>

<h3 id="visualize"><code>visualize</code><a class="headerlink" href="#visualize" title="Permanent link">&para;</a></h3>
<p>Visualize Landsat mosaic in kepler.gl.</p>
<p><img alt="" src="../assets/visualize_cli.jpg" /></p>
<div class="highlight"><pre><span></span><code>Usage: landsat-cogeo-mosaic visualize [OPTIONS] [MOSAIC_PATHS]...

  Visualize Landsat mosaic in kepler.gl

Options:
  -p, --wrs-path PATH  Path to Shapefile (.shp) of WRS2 polygons. You can
                       download then extract from here
                       https://www.usgs.gov/media/files/landsat-
                       wrs-2-descending-path-row-shapefile  [required]
  --api-key TEXT       Mapbox API key. Can also be read from the
                       MAPBOX_API_KEY environment variable.
  --help               Show this message and exit.
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../examples/stac/" title="STAC Features" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                STAC Features
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/kylebarron" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/kylebarron2" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.2d1db4bd.min.js"></script>
      <script src="../assets/javascripts/bundle.6627ddf3.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>